module factorial

export
  ( factorial : i64 -> i64
  )

section bss

section data

section text

factorial : (n : i64) -> i64
{
  local_read_i64 n // n
  0:i64            // n 0
  cmp_i64          // (n `cmp` 0)
  jle exit1        //

  local_read_i64 n // n
  local_read_i64 n // n n
  1:i64            // n (n-1)
  sub_i64
  call 1 factorial   // n (fac (n-1))
  mul_i64          // n*(fac (n-1))
  ret

.exit1:
  1:i64            // 1
  ret
}
